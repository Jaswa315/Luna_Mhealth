# This a pipeline for just running unit tests in an adhoc manner.
# Lint and Testing pipeline for Luna mHealth
# YML that gets run when a PR is requested
trigger: none

pool:
  vmImage: ubuntu-latest

variables:
  - name: package_folders
    value: luna_core,luna_authoring_system,luna_mobile

steps:

- template: templates/install_prereqs.yml

- ${{ each folder in split(variables.package_folders, ',') }}:
  - template: templates/lint_luna.yml
    parameters:
      package_path: ${{ folder }}
      package_name: ${{ folder }}
  - template: templates/run_tests.yml
    parameters:
      package_path: ${{ folder }}
      package_name: ${{ folder }}
      include_coverage: 'false'
      test_file_name: "$(Build.SourcesDirectory)/${{ folder }}/test/all_tests.dart"

- template: templates/publish_test_lint_results.yml
  parameters:
    include_coverage: 'false'
